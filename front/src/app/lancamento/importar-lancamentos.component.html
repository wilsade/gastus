<po-modal #modalImportacao
          p-size="auto"
          p-title="Importação de lançamentos"
          [p-primary-action]="confirmou">

  <po-stepper #stepper
              (p-change-step)="alterouStep($event)">
    <po-step [p-label]="INFORMAR_DADOS"
             [p-can-active-next-step]="podeAvancarDosDados.bind(this)">

      <po-textarea class="po-md-12"
                   [p-rows]="9"
                   p-placeholder="Informe um item por linha separados por ponto-e-vírgula, pipe ou TAB"
                   [(ngModel)]="rawLines"></po-textarea>

    </po-step>

    <po-step [p-label]="PREENCHER_TABELA"
             [p-can-active-next-step]="podeAvancarDaTabela.bind(this)">
      <po-table [p-hide-columns-manager]="true"
                [p-striped]="true"
                [p-columns]="colunasTabela"
                [p-items]="dadosImportacao">

        <ng-template p-table-cell-template
                     let-column="column"
                     let-row="row">

          <div *ngIf="column.property === 'Valor'">
            <app-coluna-valor [valor]="row.Valor"></app-coluna-valor>
          </div>

          <div *ngIf="column.property === 'NomeCategoria'">
            <po-input class="po-md-12"
                      p-required="true"
                      [(ngModel)]="row.NomeCategoria"></po-input>
          </div>

          <div *ngIf="column.property === 'NomeSubCategoria'">
            <po-input class="po-md-12"
                      p-required="true"
                      [(ngModel)]="row.NomeSubCategoria"></po-input>
          </div>

          <div *ngIf="column.property === 'Comentario'">
            <po-input class="po-md-12"
                      [(ngModel)]="row.Comentario"></po-input>
          </div>

          <div *ngIf="column.property === 'NomeTipoTransacao'">
            <po-select class="po-md-12"
                       [p-options]="tiposTransacao"
                       [ngModel]="row.IdTipoTransacao"
                       (ngModelChange)="row.IdTipoTransacao = $event"></po-select>
          </div>

        </ng-template>

      </po-table>
    </po-step>
    <po-step [p-label]="VALIDACAO_CONFIRMACAO"
             [p-can-active-next-step]="podeAvancarDaValidacao.bind(this)">
      <div class="po-row">
        <strong style="margin-right: 9px; margin-left: 9px;">Saldo atual:</strong> <span
              style="color: blue; margin-right: 9px;">{{getTotal()}}</span>
        <po-checkbox class="po-md-6"
                     p-label="Confirmar importação"
                     [(ngModel)]="confirmouImportacao"></po-checkbox>

      </div>
      <po-divider></po-divider>
      <po-table [p-striped]="true"
                [p-hide-columns-manager]="true"
                [p-columns]="colunasConfirmacao"
                [p-items]="lancamentosParaInsercao">

        <ng-template p-table-cell-template
                     let-column="column"
                     let-row="row">

          <div *ngIf="column.property === 'Valor'">
            <app-coluna-valor [valor]="row.Valor"></app-coluna-valor>
          </div>

          <div *ngIf="column.property === 'SALDO'">
            <app-coluna-valor [valor]="row.SALDO"></app-coluna-valor>
          </div>
        </ng-template>

      </po-table>
    </po-step>
    <po-step [p-label]="TERMINO"></po-step>
  </po-stepper>
</po-modal>